<!-- ns-3 doxygen header, based on
     HTML header for doxygen 1.8.3.1
     Verified compatible with 1.8.6
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta name="generator" content="Doxygen 1.8.13" />
  <title>MilliCar: model/mmwave-sidelink-mac.cc Source File</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
  <link href="favicon.ico" rel="shortcut icon" type="image/ico">
  </link>
  <script type="text/javascript" src="drop-down-menu.js"></script>
</head>
<body>
  <div id="top">
    <!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0" width="100%">
        <tbody>
          <tr style="height: 56px;">
            <td id="projectlogo">
              <a id="home" href="http://signet.dei.unipd.it/" target="_blank">
                <img alt="signet logo" src="logo_signet.png" />
              </a>
            </td>
            <td id="projecttext">
              <div id="projectbrief">MilliCar: An ns-3 Module for NR V2X Networks</div>
            </td>
            <td id="projectsection">
              <span style="margin-right:10px">API Documentation</span>
            </td>
          </tr>
        </tbody>
      </table>
      <script type="text/javascript">
        ns3_write_links();
      </script>
    </div>
    <!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mmwave-sidelink-mac_8cc_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mmwave-sidelink-mac.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mmwave-sidelink-mac_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* -*- Mode:C++; c-file-style:&quot;gnu&quot;; indent-tabs-mode:nil; -*- */</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">*   Copyright (c) 2020 University of Padova, Dep. of Information Engineering,</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">*   SIGNET lab.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">*   This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*   it under the terms of the GNU General Public License version 2 as</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*   published by the Free Software Foundation;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">*   GNU General Public License for more details.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">*   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">*   along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;ns3/mmwave-phy-mac-common.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;ns3/mmwave-amc.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;ns3/lte-mac-sap.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;ns3/lte-radio-bearer-tag.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mmwave-sidelink-mac_8h.html">mmwave-sidelink-mac.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;ns3/log.h&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;ns3/uinteger.h&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;ns3/boolean.h&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacens3.html">ns3</a> {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;NS_LOG_COMPONENT_DEFINE (<span class="stringliteral">&quot;MmWaveSidelinkMac&quot;</span>);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemillicar.html">millicar</a> {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a52793da75596df4b84a8504274a6deb8">   35</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a52793da75596df4b84a8504274a6deb8">MacSidelinkMemberPhySapUser::MacSidelinkMemberPhySapUser</a> (Ptr&lt;MmWaveSidelinkMac&gt; mac)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  : m_mac (mac)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a430a252dfedeea5228eab8e62af82960">   42</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a430a252dfedeea5228eab8e62af82960">MacSidelinkMemberPhySapUser::ReceivePhyPdu</a> (Ptr&lt;Packet&gt; p)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#aea644131eb902c3dfb5d3273d0dfa389">m_mac</a>-&gt;DoReceivePhyPdu (p);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#ae204b07ff1b6fcd8d50dc71d21b51278">   48</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#ae204b07ff1b6fcd8d50dc71d21b51278">MacSidelinkMemberPhySapUser::SlotIndication</a> (mmwave::SfnSf timingInfo)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#aea644131eb902c3dfb5d3273d0dfa389">m_mac</a>-&gt;DoSlotIndication (timingInfo);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a68dd0cadd60b7bf0d2a3ac34a15a8e4c">   54</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a68dd0cadd60b7bf0d2a3ac34a15a8e4c">MacSidelinkMemberPhySapUser::SlSinrReport</a> (<span class="keyword">const</span> SpectrumValue&amp; sinr, uint16_t rnti, uint8_t numSym, uint32_t tbSize)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#aea644131eb902c3dfb5d3273d0dfa389">m_mac</a>-&gt;DoSlSinrReport (sinr, rnti, numSym, tbSize);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#a178e79caf8df4d7bb738bb0dbef70530">   61</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#a178e79caf8df4d7bb738bb0dbef70530">RlcSidelinkMemberMacSapProvider::RlcSidelinkMemberMacSapProvider</a> (Ptr&lt;MmWaveSidelinkMac&gt; mac)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  : <a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#aea644131eb902c3dfb5d3273d0dfa389">m_mac</a> (mac)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;{</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#ae05a79a4fc56b618d90130ec39c9009d">   68</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#ae05a79a4fc56b618d90130ec39c9009d">RlcSidelinkMemberMacSapProvider::TransmitPdu</a> (TransmitPduParameters params)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#aad942dd8576e4a0c9e23d25834755ad2">m_mac</a>-&gt;DoTransmitPdu (params);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#ac15e814e840c8b50cbfa7c60eef287dd">   74</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#ac15e814e840c8b50cbfa7c60eef287dd">RlcSidelinkMemberMacSapProvider::ReportBufferStatus</a> (ReportBufferStatusParameters params)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#aad942dd8576e4a0c9e23d25834755ad2">m_mac</a>-&gt;DoReportBufferStatus (params);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">//-----------------------------------------------------------------------</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;NS_OBJECT_ENSURE_REGISTERED (<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html">MmWaveSidelinkMac</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;TypeId</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a97fdea26e60baec2ab5f082da054e18e">   84</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a97fdea26e60baec2ab5f082da054e18e">MmWaveSidelinkMac::GetTypeId</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">static</span> TypeId tid = TypeId (<span class="stringliteral">&quot;ns3::MmWaveSidelinkMac&quot;</span>)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    .SetParent&lt;Object&gt; ()</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    .AddAttribute (<span class="stringliteral">&quot;Mcs&quot;</span>,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                   <span class="stringliteral">&quot;If AMC is not used, specify a fixed MCS value.&quot;</span>,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                   UintegerValue (0),</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                   MakeUintegerAccessor (&amp;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a7f989e529aeb7dea4501070860e63bc6">MmWaveSidelinkMac::m_mcs</a>),</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                   MakeUintegerChecker&lt;uint8_t&gt; (0, 28))</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    .AddAttribute (<span class="stringliteral">&quot;UseAmc&quot;</span>,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                   <span class="stringliteral">&quot;Set to true to use adaptive modulation and coding.&quot;</span>,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                   BooleanValue (<span class="keyword">true</span>),</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                   MakeBooleanAccessor (&amp;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a437ea2a96ff39d9ec2f84b7d537ac9d0">MmWaveSidelinkMac::m_useAmc</a>),</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                   MakeBooleanChecker ())</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    .AddTraceSource (<span class="stringliteral">&quot;SchedulingInfo&quot;</span>,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                     <span class="stringliteral">&quot;Information regarding the scheduling.&quot;</span>,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                     MakeTraceSourceAccessor (&amp;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a21191bfedec1e490895746bf3ad23326">MmWaveSidelinkMac::m_schedulingTrace</a>),</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                     <span class="stringliteral">&quot;ns3::millicar::MmWaveSidelinkMac::SlSchedulingTracedCallback&quot;</span>)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  ;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">return</span> tid;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ae4a82035baa66ee6c17d9b2094bacd24">  106</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a2c96de8928cbba2b7c8b0f71f2318e54">MmWaveSidelinkMac::MmWaveSidelinkMac</a> (Ptr&lt;mmwave::MmWavePhyMacCommon&gt; pmc)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  m_phyMacConfig = pmc;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// initialize the RNTI to 0</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  m_rnti = 0;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// create the PHY SAP USER</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  m_phySapUser = <span class="keyword">new</span> <a class="code" href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html">MacSidelinkMemberPhySapUser</a> (<span class="keyword">this</span>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// create the MAC SAP PROVIDER</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  m_macSapProvider = <span class="keyword">new</span> <a class="code" href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#a178e79caf8df4d7bb738bb0dbef70530">RlcSidelinkMemberMacSapProvider</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// create the mmwave::MmWaveAmc instance</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  m_amc = CreateObject &lt;mmwave::MmWaveAmc&gt; (m_phyMacConfig);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">// initialize the scheduling patter</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  std::vector&lt;uint16_t&gt; pattern (m_phyMacConfig-&gt;GetSlotsPerSubframe (), 0);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  m_sfAllocInfo = pattern;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a8a34b3d135b391d9fc16004fb91fa208">  129</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a8a34b3d135b391d9fc16004fb91fa208">MmWaveSidelinkMac::~MmWaveSidelinkMac</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af5aee81d76bc85ab6d57742cffc214de">  135</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af5aee81d76bc85ab6d57742cffc214de">MmWaveSidelinkMac::DoDispose</a> ()</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keyword">delete</span> m_phySapUser;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  Object::DoDispose ();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af1c118a5b92dfce7a7b62c55ac50c020">  143</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af1c118a5b92dfce7a7b62c55ac50c020">MmWaveSidelinkMac::DoSlotIndication</a> (mmwave::SfnSf timingInfo)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;{</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  NS_ASSERT_MSG (m_rnti != 0, <span class="stringliteral">&quot;First set the RNTI&quot;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  NS_ASSERT_MSG (!m_sfAllocInfo.empty (), <span class="stringliteral">&quot;First set the scheduling pattern&quot;</span>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">if</span>(m_sfAllocInfo [timingInfo.m_slotNum] == m_rnti) <span class="comment">// check if this slot is associated to the user who required it</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    mmwave::SlotAllocInfo allocationInfo = ScheduleResources (timingInfo);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// associate slot alloc info and pdu</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = allocationInfo.m_ttiAllocInfo.begin(); it != allocationInfo.m_ttiAllocInfo.end (); it++)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">// retrieve the tx buffer corresponding to the assigned destination</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keyword">auto</span> txBuffer = m_txBufferMap.find (it-&gt;m_rnti); <span class="comment">// the destination RNTI</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">if</span> (txBuffer == m_txBufferMap.end () || txBuffer-&gt;second.empty ())</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">// discard the tranmission opportunity and go to the next transmission</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// otherwise, forward the packet to the PHY</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      Ptr&lt;PacketBurst&gt; pb = CreateObject&lt;PacketBurst&gt; ();</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      pb-&gt;AddPacket (txBuffer-&gt;second.front ().pdu);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      m_phySapProvider-&gt;AddTransportBlock (pb, *it);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      txBuffer-&gt;second.pop_front ();</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_sfAllocInfo[timingInfo.m_slotNum] != 0) <span class="comment">// if the slot is assigned to another device, prepare for reception</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    NS_LOG_INFO (<span class="stringliteral">&quot;Prepare for reception from rnti &quot;</span> &lt;&lt; m_sfAllocInfo[timingInfo.m_slotNum]);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    m_phySapProvider-&gt;PrepareForReception (m_sfAllocInfo[timingInfo.m_slotNum]);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// the slot is not assigned to any user</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    NS_LOG_INFO (<span class="stringliteral">&quot;Empty slot&quot;</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;mmwave::SlotAllocInfo</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ac53acfff4c1460aa47e1a3a7f295bf89">  185</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ac53acfff4c1460aa47e1a3a7f295bf89">MmWaveSidelinkMac::ScheduleResources</a> (mmwave::SfnSf timingInfo)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  mmwave::SlotAllocInfo allocationInfo; <span class="comment">// stores all the allocation decisions</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  allocationInfo.m_sfnSf = timingInfo;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  allocationInfo.m_numSymAlloc = 0;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  NS_LOG_DEBUG(<span class="stringliteral">&quot;m_bufferStatusReportMap.size () =\t&quot;</span> &lt;&lt; m_bufferStatusReportMap.size ());</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// if there are no active channels return an empty vector</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (m_bufferStatusReportMap.size () == 0)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> allocationInfo;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// compute the total number of available symbols</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  uint32_t availableSymbols = m_phyMacConfig-&gt;GetSymbPerSlot ();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  NS_LOG_DEBUG(<span class="stringliteral">&quot;availableSymbols =\t&quot;</span> &lt;&lt; availableSymbols);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// compute the number of available symbols per logical channel</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// NOTE the number of available symbols per LC is rounded down due to the cast</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// to int</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  uint32_t availableSymbolsPerLc = availableSymbols / m_bufferStatusReportMap.size ();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  NS_LOG_DEBUG(<span class="stringliteral">&quot;availableSymbolsPerLc =\t&quot;</span> &lt;&lt; availableSymbolsPerLc);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// TODO start from the last served lc + 1</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keyword">auto</span> bsrIt = m_bufferStatusReportMap.begin ();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  uint8_t symStart = 0; <span class="comment">// indicates the next available symbol in the slot</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// serve the active logical channels with a Round Robin approach</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">while</span> (availableSymbols &gt; 0 &amp;&amp; m_bufferStatusReportMap.size () &gt; 0)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    uint16_t rntiDest = bsrIt-&gt;second.rnti; <span class="comment">// the RNTI of the destination node</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    uint8_t mcs = GetMcs (rntiDest); <span class="comment">// select the MCS</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    NS_LOG_DEBUG(<span class="stringliteral">&quot;rnti &quot;</span> &lt;&lt; rntiDest &lt;&lt; <span class="stringliteral">&quot; mcs = &quot;</span> &lt;&lt; uint16_t(mcs));</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// compute the number of bits for this LC</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    uint32_t availableBitsPerLc = m_amc-&gt;GetTbSizeFromMcsSymbols(mcs, availableSymbolsPerLc);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// compute the number of bits required by this LC</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    uint32_t requiredBits = (bsrIt-&gt;second.txQueueSize + bsrIt-&gt;second.retxQueueSize + bsrIt-&gt;second.statusPduSize) * 8;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// assign a number of bits which is less or equal to the available bits</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    uint32_t assignedBits = 0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (requiredBits &lt;= availableBitsPerLc)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      assignedBits = requiredBits;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      assignedBits = availableBitsPerLc;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// compute the number of symbols assigned to this LC</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    uint32_t assignedSymbols = m_amc-&gt;GetNumSymbolsFromTbsMcs (assignedBits, mcs);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    NS_LOG_DEBUG(<span class="stringliteral">&quot;assignedSymbols =\t&quot;</span> &lt;&lt; assignedSymbols);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">//if (assignedSymbols &lt;= availableSymbols) // TODO check if needed</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">//{</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// create the TtiAllocInfo object</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    mmwave::TtiAllocInfo info;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    info.m_ttiIdx = timingInfo.m_slotNum; <span class="comment">// the TB will be sent in this slot</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    info.m_rnti = rntiDest; <span class="comment">// the RNTI of the destination node</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    info.m_dci.m_rnti = m_rnti; <span class="comment">// my RNTI</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    info.m_dci.m_numSym = assignedSymbols; <span class="comment">// the number of symbols required to tx the packet</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    info.m_dci.m_symStart = symStart; <span class="comment">// index of the first available symbol</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    info.m_dci.m_mcs = mcs;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    info.m_dci.m_tbSize = assignedBits / 8; <span class="comment">// the TB size in bytes</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    info.m_ttiType = mmwave::TtiAllocInfo::TddTtiType::DATA; <span class="comment">// the TB carries data</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    NS_LOG_DEBUG(<span class="stringliteral">&quot;info.m_dci.m_tbSize =\t&quot;</span> &lt;&lt; info.m_dci.m_tbSize);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    allocationInfo.m_ttiAllocInfo.push_back (info);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    allocationInfo.m_numSymAlloc += assignedSymbols;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// fire the scheduling trace</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html">SlSchedulingCallback</a> traceInfo;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a1831e165e5378c4dc2e066795ff74028">frame</a> = timingInfo.m_frameNum;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a2acac5daa2ebddd899fe9710eb37c236">subframe</a> = timingInfo.m_sfNum;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#ae9162a29fa9912872f27bd9a5045e957">slotNum</a> = timingInfo.m_slotNum;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a94e0908bfa763bb1995a24bc855efb2a">symStart</a> = symStart;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#aeba85dc92c38c749b32d241abc30484d">numSym</a> = assignedSymbols;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a1508f2b45509925dda62e706223dd3f5">mcs</a> = mcs;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a85afa95aa23c0a26f5526a198419bb3c">tbSize</a> = assignedBits / 8;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#adb434f6533e5a07eac34e2a12fd93dd7">txRnti</a> = m_rnti;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    traceInfo.<a class="code" href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a68acb66f9d0cc3e2387436922f4c0c03">rxRnti</a> = rntiDest;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    m_schedulingTrace (traceInfo);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// notify the RLC</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    LteMacSapUser* macSapUser = m_lcidToMacSap.find (bsrIt-&gt;second.lcid)-&gt;second;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    LteMacSapUser::TxOpportunityParameters params;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    params.bytes = assignedBits / 8;  <span class="comment">// the number of bytes to transmit</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    params.layer = 0;  <span class="comment">// the layer of transmission (MIMO) (NOT USED)</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    params.harqId = 0; <span class="comment">// the HARQ ID (NOT USED)</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    params.componentCarrierId = 0; <span class="comment">// the component carrier id (NOT USED)</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    params.rnti = rntiDest; <span class="comment">// the C-RNTI identifying the destination</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    params.lcid = bsrIt-&gt;second.lcid; <span class="comment">// the logical channel id</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    macSapUser-&gt;NotifyTxOpportunity (params);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// update the entry in the m_bufferStatusReportMap (delete it if no</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// further resources are needed)</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    bsrIt = UpdateBufferStatusReport (bsrIt-&gt;second.lcid, assignedBits / 8);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// update the number of available symbols</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    availableSymbols -= assignedSymbols;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// update the availableSymbolsPerLc (if needed)</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (availableSymbols &lt; availableSymbolsPerLc)</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      availableSymbolsPerLc = availableSymbols;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// update index to the next available symbol</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    symStart = symStart + assignedSymbols;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// if the iterator reached the end of the map, start again</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (bsrIt == m_bufferStatusReportMap.end ())</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      bsrIt = m_bufferStatusReportMap.begin ();</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">return</span> allocationInfo;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;std::map&lt;uint8_t, LteMacSapProvider::ReportBufferStatusParameters&gt;::iterator</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a7c4b22c8a1c6f7d71bdce5ae490647a2">  313</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a7c4b22c8a1c6f7d71bdce5ae490647a2">MmWaveSidelinkMac::UpdateBufferStatusReport</a> (uint8_t lcid, uint32_t assignedBytes)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// find the corresponding entry in the map</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keyword">auto</span> bsrIt = m_bufferStatusReportMap.find (lcid);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  NS_ASSERT_MSG (bsrIt != m_bufferStatusReportMap.end (), <span class="stringliteral">&quot;m_bufferStatusReportMap does not contain the required entry&quot;</span>);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// NOTE RLC transmits PDUs in the following priority order:</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// 1) STATUS PDUs</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// 2) retransmissions</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="comment">// 3) regular PDUs</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (bsrIt-&gt;second.statusPduSize &gt; assignedBytes)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    bsrIt-&gt;second.statusPduSize -= assignedBytes;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    assignedBytes = 0;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    assignedBytes -= bsrIt-&gt;second.statusPduSize;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    bsrIt-&gt;second.statusPduSize = 0;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">if</span> (bsrIt-&gt;second.retxQueueSize &gt; assignedBytes)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    bsrIt-&gt;second.retxQueueSize -= assignedBytes;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    assignedBytes = 0;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    assignedBytes -= bsrIt-&gt;second.retxQueueSize;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    bsrIt-&gt;second.retxQueueSize = 0;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">if</span> (bsrIt-&gt;second.txQueueSize &gt; assignedBytes)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    bsrIt-&gt;second.txQueueSize -= assignedBytes;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    assignedBytes = 0;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    assignedBytes -= bsrIt-&gt;second.txQueueSize;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    bsrIt-&gt;second.txQueueSize = 0;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// delete the entry in the map if no further resources are needed</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">if</span> (bsrIt-&gt;second.statusPduSize == 0 &amp;&amp; bsrIt-&gt;second.retxQueueSize == 0  &amp;&amp; bsrIt-&gt;second.txQueueSize == 0)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    bsrIt = m_bufferStatusReportMap.erase (bsrIt);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    bsrIt++;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">return</span> bsrIt;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#acc4ace5cc716ee66fe1434502d7b4346">  371</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#acc4ace5cc716ee66fe1434502d7b4346">MmWaveSidelinkMac::DoReportBufferStatus</a> (LteMacSapProvider::ReportBufferStatusParameters params)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keyword">auto</span> bsrIt = m_bufferStatusReportMap.find (params.lcid);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">if</span> (bsrIt != m_bufferStatusReportMap.end ())</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    bsrIt-&gt;second = params;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    NS_LOG_DEBUG(<span class="stringliteral">&quot;Update buffer status report for LCID &quot;</span> &lt;&lt; uint32_t(params.lcid));</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    m_bufferStatusReportMap.insert (std::make_pair (params.lcid, params));</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    NS_LOG_DEBUG(<span class="stringliteral">&quot;Insert buffer status report for LCID &quot;</span> &lt;&lt; uint32_t(params.lcid));</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a36bc120898406b4fa124ec340266e30a">  389</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a36bc120898406b4fa124ec340266e30a">MmWaveSidelinkMac::DoTransmitPdu</a> (LteMacSapProvider::TransmitPduParameters params)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  LteRadioBearerTag tag (params.rnti, params.lcid, params.layer);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  params.pdu-&gt;AddPacketTag (tag);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">//insert the packet at the end of the buffer</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  NS_LOG_DEBUG(<span class="stringliteral">&quot;Add packet for RNTI &quot;</span> &lt;&lt; params.rnti &lt;&lt; <span class="stringliteral">&quot; LCID &quot;</span> &lt;&lt; uint32_t(params.lcid));</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keyword">auto</span> it = m_txBufferMap.find (params.rnti);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span> (it == m_txBufferMap.end ())</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    std::list&lt;LteMacSapProvider::TransmitPduParameters&gt; txBuffer;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    txBuffer.push_back (params);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    m_txBufferMap.insert (std::make_pair (params.rnti, txBuffer));</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    it-&gt;second.push_back (params);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00412"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#acc0368ede49b1400c2e4e29429818f32">  412</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#acc0368ede49b1400c2e4e29429818f32">MmWaveSidelinkMac::DoReceivePhyPdu</a> (Ptr&lt;Packet&gt; p)</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  NS_LOG_FUNCTION(<span class="keyword">this</span> &lt;&lt; p);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  LteMacSapUser::ReceivePduParameters rxPduParams;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  LteRadioBearerTag tag;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  p-&gt;PeekPacketTag (tag);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// pick the right lcid associated to this communication. As discussed, this can be done via a dedicated SidelinkBearerTag</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  rxPduParams.p = p;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  rxPduParams.rnti = tag.GetRnti ();</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  rxPduParams.lcid = tag.GetLcid ();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  NS_LOG_DEBUG (<span class="stringliteral">&quot;Received a packet &quot;</span> &lt;&lt; rxPduParams.rnti &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (uint16_t)rxPduParams.lcid);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  LteMacSapUser* macSapUser = m_lcidToMacSap.find(rxPduParams.lcid)-&gt;second;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  macSapUser-&gt;ReceivePdu (rxPduParams);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_phy_sap_user.html">MmWaveSidelinkPhySapUser</a>*</div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ae6a8f2b11ed7ac5d33dc0629937695e6">  432</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ae6a8f2b11ed7ac5d33dc0629937695e6">MmWaveSidelinkMac::GetPhySapUser</a> ()<span class="keyword"> const</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordflow">return</span> m_phySapUser;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a42acefcfc918c3500669e32e40bf42a0">  439</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a42acefcfc918c3500669e32e40bf42a0">MmWaveSidelinkMac::SetPhySapProvider</a> (<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_phy_sap_provider.html">MmWaveSidelinkPhySapProvider</a>* sap)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;{</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  m_phySapProvider = sap;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;LteMacSapProvider*</div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a9ac166a4e4d5e2449cb0e69a165719cb">  446</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a9ac166a4e4d5e2449cb0e69a165719cb">MmWaveSidelinkMac::GetMacSapProvider</a> ()<span class="keyword"> const</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">return</span> m_macSapProvider;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af1686c0688c1bafeccb463ea2bc6f828">  453</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af1686c0688c1bafeccb463ea2bc6f828">MmWaveSidelinkMac::SetRnti</a> (uint16_t rnti)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;{</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  m_rnti = rnti;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;uint16_t</div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a229809ca241dc9416dfb8ec82d8e48f6">  459</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a229809ca241dc9416dfb8ec82d8e48f6">MmWaveSidelinkMac::GetRnti</a> ()<span class="keyword"> const</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">return</span> m_rnti;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a3862171847195f4cf9122fb8f05ed3eb">  465</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a3862171847195f4cf9122fb8f05ed3eb">MmWaveSidelinkMac::SetSfAllocationInfo</a> (std::vector&lt;uint16_t&gt; pattern)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  NS_ASSERT_MSG (pattern.size () == m_phyMacConfig-&gt;GetSlotsPerSubframe (), <span class="stringliteral">&quot;The number of pattern elements must be equal to the number of slots per subframe&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  m_sfAllocInfo = pattern;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af303cc45866c7094f9f2c36bbaa0a66c">  473</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af303cc45866c7094f9f2c36bbaa0a66c">MmWaveSidelinkMac::SetForwardUpCallback</a> (Callback &lt;<span class="keywordtype">void</span>, Ptr&lt;Packet&gt; &gt; cb)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  m_forwardUpCallback = cb;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a3f08eb574db4cc92b29130d0027b44ca">  479</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a3f08eb574db4cc92b29130d0027b44ca">MmWaveSidelinkMac::DoSlSinrReport</a> (<span class="keyword">const</span> SpectrumValue&amp; sinr, uint16_t rnti, uint8_t numSym, uint32_t tbSize)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;{</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// check if the m_slCqiReported already contains the CQI history for the device</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// with RNTI = rnti. If so, add the new CQI report, otherwise create a new</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// entry.</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordtype">int</span> mcs; <span class="comment">// the selected MCS will be stored in this variable</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">if</span> (m_slCqiReported.find (rnti) != m_slCqiReported.end () )</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    m_slCqiReported.at (rnti).push_back (m_amc-&gt;CreateCqiFeedbackWbTdma (sinr, numSym, tbSize, mcs));</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    std::vector&lt;int&gt; cqiTemp;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    cqiTemp.push_back (m_amc-&gt;CreateCqiFeedbackWbTdma (sinr, numSym, tbSize, mcs));</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    m_slCqiReported.insert (std::make_pair(rnti, cqiTemp));</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;uint8_t</div><div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a5b655c0cec3c9919fc7c8609d6e70e29">  500</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a5b655c0cec3c9919fc7c8609d6e70e29">MmWaveSidelinkMac::GetMcs</a> (uint16_t rnti)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;{</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  uint8_t mcs; <span class="comment">// the selected MCS</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (m_useAmc)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// if AMC is used, select the MCS based on the CQI history</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (m_slCqiReported.find (rnti) != m_slCqiReported.end ())</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      std::vector &lt;int&gt; cqi = m_slCqiReported.find (rnti)-&gt;second;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      mcs = m_amc-&gt;GetMcsFromCqi(cqi.back ());</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      mcs = 0; <span class="comment">// if the CQI history not found for this device, use the minimum MCS value</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// if AMC is not used, use a fixed MCS value</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    mcs = m_mcs;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// TODO: update the method to refresh CQI reports and delete older reports</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">return</span> mcs;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ad4c32a42bd58226a3ad07828e7b4cff0">  528</a></span>&#160;<a class="code" href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ad4c32a42bd58226a3ad07828e7b4cff0">MmWaveSidelinkMac::AddMacSapUser</a> (uint8_t lcid, LteMacSapUser* macSapUser)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  NS_LOG_FUNCTION (<span class="keyword">this</span>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  m_lcidToMacSap.insert(std::make_pair(lcid, macSapUser));</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;} <span class="comment">// mmwave namespace</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;} <span class="comment">// ns3 namespace</span></div><div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html">ns3::millicar::MmWaveSidelinkMac</a></div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00046">mmwave-sidelink-mac.h:46</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_a1508f2b45509925dda62e706223dd3f5"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a1508f2b45509925dda62e706223dd3f5">ns3::millicar::SlSchedulingCallback::mcs</a></div><div class="ttdeci">uint8_t mcs</div><div class="ttdoc">the MCS for transport block </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00040">mmwave-sidelink-mac.h:40</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a36bc120898406b4fa124ec340266e30a"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a36bc120898406b4fa124ec340266e30a">ns3::millicar::MmWaveSidelinkMac::DoTransmitPdu</a></div><div class="ttdeci">void DoTransmitPdu(LteMacSapProvider::TransmitPduParameters params)</div><div class="ttdoc">Transmit PDU function. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00389">mmwave-sidelink-mac.cc:389</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a42acefcfc918c3500669e32e40bf42a0"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a42acefcfc918c3500669e32e40bf42a0">ns3::millicar::MmWaveSidelinkMac::SetPhySapProvider</a></div><div class="ttdeci">void SetPhySapProvider(MmWaveSidelinkPhySapProvider *sap)</div><div class="ttdoc">Set the PHY SAP provider. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00439">mmwave-sidelink-mac.cc:439</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a7f989e529aeb7dea4501070860e63bc6"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a7f989e529aeb7dea4501070860e63bc6">ns3::millicar::MmWaveSidelinkMac::m_mcs</a></div><div class="ttdeci">uint8_t m_mcs</div><div class="ttdoc">the MCS used to transmit the packets if AMC is not used </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00210">mmwave-sidelink-mac.h:210</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_a94e0908bfa763bb1995a24bc855efb2a"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a94e0908bfa763bb1995a24bc855efb2a">ns3::millicar::SlSchedulingCallback::symStart</a></div><div class="ttdeci">uint8_t symStart</div><div class="ttdoc">index of the starting symbol </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00038">mmwave-sidelink-mac.h:38</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_a85afa95aa23c0a26f5526a198419bb3c"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a85afa95aa23c0a26f5526a198419bb3c">ns3::millicar::SlSchedulingCallback::tbSize</a></div><div class="ttdeci">uint16_t tbSize</div><div class="ttdoc">the TB size in bytes </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00041">mmwave-sidelink-mac.h:41</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a7c4b22c8a1c6f7d71bdce5ae490647a2"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a7c4b22c8a1c6f7d71bdce5ae490647a2">ns3::millicar::MmWaveSidelinkMac::UpdateBufferStatusReport</a></div><div class="ttdeci">std::map&lt; uint8_t, LteMacSapProvider::ReportBufferStatusParameters &gt;::iterator UpdateBufferStatusReport(uint8_t lcid, uint32_t assignedBytes)</div><div class="ttdoc">Updates the BSR corresponding to the specified LC by subtracting the assigned grant. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00313">mmwave-sidelink-mac.cc:313</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a3f08eb574db4cc92b29130d0027b44ca"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a3f08eb574db4cc92b29130d0027b44ca">ns3::millicar::MmWaveSidelinkMac::DoSlSinrReport</a></div><div class="ttdeci">void DoSlSinrReport(const SpectrumValue &amp;sinr, uint16_t rnti, uint8_t numSym, uint32_t tbSize)</div><div class="ttdoc">Based on the SINR reported, the CQI is evaluated and pushed to the CQIs history with the latest SINR ...</div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00479">mmwave-sidelink-mac.cc:479</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_af5aee81d76bc85ab6d57742cffc214de"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af5aee81d76bc85ab6d57742cffc214de">ns3::millicar::MmWaveSidelinkMac::DoDispose</a></div><div class="ttdeci">virtual void DoDispose(void)</div><div class="ttdoc">Destructor implementation. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00135">mmwave-sidelink-mac.cc:135</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider_html_a178e79caf8df4d7bb738bb0dbef70530"><div class="ttname"><a href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#a178e79caf8df4d7bb738bb0dbef70530">ns3::millicar::RlcSidelinkMemberMacSapProvider::RlcSidelinkMemberMacSapProvider</a></div><div class="ttdeci">RlcSidelinkMemberMacSapProvider(Ptr&lt; MmWaveSidelinkMac &gt; mac)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00061">mmwave-sidelink-mac.cc:61</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_a1831e165e5378c4dc2e066795ff74028"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a1831e165e5378c4dc2e066795ff74028">ns3::millicar::SlSchedulingCallback::frame</a></div><div class="ttdeci">uint16_t frame</div><div class="ttdoc">frame number </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00035">mmwave-sidelink-mac.h:35</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_af303cc45866c7094f9f2c36bbaa0a66c"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af303cc45866c7094f9f2c36bbaa0a66c">ns3::millicar::MmWaveSidelinkMac::SetForwardUpCallback</a></div><div class="ttdeci">void SetForwardUpCallback(Callback&lt; void, Ptr&lt; Packet &gt; &gt; cb)</div><div class="ttdoc">set the callback used to forward data packets up to the NetDevice </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00473">mmwave-sidelink-mac.cc:473</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user_html_a430a252dfedeea5228eab8e62af82960"><div class="ttname"><a href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a430a252dfedeea5228eab8e62af82960">ns3::millicar::MacSidelinkMemberPhySapUser::ReceivePhyPdu</a></div><div class="ttdeci">void ReceivePhyPdu(Ptr&lt; Packet &gt; p) override</div><div class="ttdoc">Called by the PHY to notify the MAC of the reception of a new PHY-PDU. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00042">mmwave-sidelink-mac.cc:42</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_ac53acfff4c1460aa47e1a3a7f295bf89"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ac53acfff4c1460aa47e1a3a7f295bf89">ns3::millicar::MmWaveSidelinkMac::ScheduleResources</a></div><div class="ttdeci">mmwave::SlotAllocInfo ScheduleResources(mmwave::SfnSf timingInfo)</div><div class="ttdoc">Decides how to allocate the available resources to the active logical channels. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00185">mmwave-sidelink-mac.cc:185</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_phy_sap_provider_html"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_phy_sap_provider.html">ns3::millicar::MmWaveSidelinkPhySapProvider</a></div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-sap_8h_source.html#l00033">mmwave-sidelink-sap.h:33</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user_html"><div class="ttname"><a href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html">ns3::millicar::MacSidelinkMemberPhySapUser</a></div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00222">mmwave-sidelink-mac.h:222</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a2c96de8928cbba2b7c8b0f71f2318e54"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a2c96de8928cbba2b7c8b0f71f2318e54">ns3::millicar::MmWaveSidelinkMac::MmWaveSidelinkMac</a></div><div class="ttdeci">MmWaveSidelinkMac(void)=delete</div><div class="ttdoc">Delete default constructor to avoid misuse. </div></div>
<div class="ttc" id="namespacens3_html"><div class="ttname"><a href="namespacens3.html">ns3</a></div><div class="ttdoc">Every class exported by the ns3 library is enclosed in the ns3 namespace. </div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user_html_a68dd0cadd60b7bf0d2a3ac34a15a8e4c"><div class="ttname"><a href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a68dd0cadd60b7bf0d2a3ac34a15a8e4c">ns3::millicar::MacSidelinkMemberPhySapUser::SlSinrReport</a></div><div class="ttdeci">void SlSinrReport(const SpectrumValue &amp;sinr, uint16_t rnti, uint8_t numSym, uint32_t tbSize) override</div><div class="ttdoc">Reports the SINR meausured with a certain device. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00054">mmwave-sidelink-mac.cc:54</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_af1686c0688c1bafeccb463ea2bc6f828"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af1686c0688c1bafeccb463ea2bc6f828">ns3::millicar::MmWaveSidelinkMac::SetRnti</a></div><div class="ttdeci">void SetRnti(uint16_t rnti)</div><div class="ttdoc">assign a proper value to the RNTI associated to a specific user </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00453">mmwave-sidelink-mac.cc:453</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a3862171847195f4cf9122fb8f05ed3eb"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a3862171847195f4cf9122fb8f05ed3eb">ns3::millicar::MmWaveSidelinkMac::SetSfAllocationInfo</a></div><div class="ttdeci">void SetSfAllocationInfo(std::vector&lt; uint16_t &gt; pattern)</div><div class="ttdoc">set the subframe allocation pattern </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00465">mmwave-sidelink-mac.cc:465</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_acc0368ede49b1400c2e4e29429818f32"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#acc0368ede49b1400c2e4e29429818f32">ns3::millicar::MmWaveSidelinkMac::DoReceivePhyPdu</a></div><div class="ttdeci">void DoReceivePhyPdu(Ptr&lt; Packet &gt; p)</div><div class="ttdoc">Receive PHY PDU function. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00412">mmwave-sidelink-mac.cc:412</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a437ea2a96ff39d9ec2f84b7d537ac9d0"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a437ea2a96ff39d9ec2f84b7d537ac9d0">ns3::millicar::MmWaveSidelinkMac::m_useAmc</a></div><div class="ttdeci">bool m_useAmc</div><div class="ttdoc">set to true to use adaptive modulation and coding </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00209">mmwave-sidelink-mac.h:209</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a9ac166a4e4d5e2449cb0e69a165719cb"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a9ac166a4e4d5e2449cb0e69a165719cb">ns3::millicar::MmWaveSidelinkMac::GetMacSapProvider</a></div><div class="ttdeci">LteMacSapProvider * GetMacSapProvider() const</div><div class="ttdoc">return the MAC SAP provider </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00446">mmwave-sidelink-mac.cc:446</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider_html_ae05a79a4fc56b618d90130ec39c9009d"><div class="ttname"><a href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#ae05a79a4fc56b618d90130ec39c9009d">ns3::millicar::RlcSidelinkMemberMacSapProvider::TransmitPdu</a></div><div class="ttdeci">virtual void TransmitPdu(TransmitPduParameters params)</div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00068">mmwave-sidelink-mac.cc:68</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_af1c118a5b92dfce7a7b62c55ac50c020"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#af1c118a5b92dfce7a7b62c55ac50c020">ns3::millicar::MmWaveSidelinkMac::DoSlotIndication</a></div><div class="ttdeci">void DoSlotIndication(mmwave::SfnSf timingInfo)</div><div class="ttdoc">trigger the start of a new slot with all the necessary information </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00143">mmwave-sidelink-mac.cc:143</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_phy_sap_user_html"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_phy_sap_user.html">ns3::millicar::MmWaveSidelinkPhySapUser</a></div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-sap_8h_source.html#l00056">mmwave-sidelink-sap.h:56</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_acc4ace5cc716ee66fe1434502d7b4346"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#acc4ace5cc716ee66fe1434502d7b4346">ns3::millicar::MmWaveSidelinkMac::DoReportBufferStatus</a></div><div class="ttdeci">void DoReportBufferStatus(LteMacSapProvider::ReportBufferStatusParameters params)</div><div class="ttdoc">Implements RlcSidelinkMemberMacSapProvider::ReportBufferStatus, reports the RLC buffer status to the ...</div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00371">mmwave-sidelink-mac.cc:371</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user_html_a52793da75596df4b84a8504274a6deb8"><div class="ttname"><a href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#a52793da75596df4b84a8504274a6deb8">ns3::millicar::MacSidelinkMemberPhySapUser::MacSidelinkMemberPhySapUser</a></div><div class="ttdeci">MacSidelinkMemberPhySapUser(Ptr&lt; MmWaveSidelinkMac &gt; mac)</div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00035">mmwave-sidelink-mac.cc:35</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user_html_aea644131eb902c3dfb5d3273d0dfa389"><div class="ttname"><a href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#aea644131eb902c3dfb5d3273d0dfa389">ns3::millicar::MacSidelinkMemberPhySapUser::m_mac</a></div><div class="ttdeci">Ptr&lt; MmWaveSidelinkMac &gt; m_mac</div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00235">mmwave-sidelink-mac.h:235</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a97fdea26e60baec2ab5f082da054e18e"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a97fdea26e60baec2ab5f082da054e18e">ns3::millicar::MmWaveSidelinkMac::GetTypeId</a></div><div class="ttdeci">static TypeId GetTypeId(void)</div><div class="ttdoc">Get the type ID. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00084">mmwave-sidelink-mac.cc:84</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_ae9162a29fa9912872f27bd9a5045e957"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#ae9162a29fa9912872f27bd9a5045e957">ns3::millicar::SlSchedulingCallback::slotNum</a></div><div class="ttdeci">uint8_t slotNum</div><div class="ttdoc">slot number </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00037">mmwave-sidelink-mac.h:37</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider_html_aad942dd8576e4a0c9e23d25834755ad2"><div class="ttname"><a href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#aad942dd8576e4a0c9e23d25834755ad2">ns3::millicar::RlcSidelinkMemberMacSapProvider::m_mac</a></div><div class="ttdeci">Ptr&lt; MmWaveSidelinkMac &gt; m_mac</div><div class="ttdoc">the MAC class </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00254">mmwave-sidelink-mac.h:254</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a21191bfedec1e490895746bf3ad23326"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a21191bfedec1e490895746bf3ad23326">ns3::millicar::MmWaveSidelinkMac::m_schedulingTrace</a></div><div class="ttdeci">TracedCallback&lt; SlSchedulingCallback &gt; m_schedulingTrace</div><div class="ttdoc">trace source returning information regarding the scheduling </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00219">mmwave-sidelink-mac.h:219</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_adb434f6533e5a07eac34e2a12fd93dd7"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#adb434f6533e5a07eac34e2a12fd93dd7">ns3::millicar::SlSchedulingCallback::txRnti</a></div><div class="ttdeci">uint16_t txRnti</div><div class="ttdoc">the RNTI which identifies the sender </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00042">mmwave-sidelink-mac.h:42</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a5b655c0cec3c9919fc7c8609d6e70e29"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a5b655c0cec3c9919fc7c8609d6e70e29">ns3::millicar::MmWaveSidelinkMac::GetMcs</a></div><div class="ttdeci">uint8_t GetMcs(uint16_t rnti)</div><div class="ttdoc">Evaluate the MCS of the link towards a specific device. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00500">mmwave-sidelink-mac.cc:500</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_ae6a8f2b11ed7ac5d33dc0629937695e6"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ae6a8f2b11ed7ac5d33dc0629937695e6">ns3::millicar::MmWaveSidelinkMac::GetPhySapUser</a></div><div class="ttdeci">MmWaveSidelinkPhySapUser * GetPhySapUser() const</div><div class="ttdoc">Get the PHY SAP user. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00432">mmwave-sidelink-mac.cc:432</a></div></div>
<div class="ttc" id="namespacemillicar_html"><div class="ttname"><a href="namespacemillicar.html">millicar</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html">ns3::millicar::SlSchedulingCallback</a></div><div class="ttdoc">structure used for the scheduling info callback </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00033">mmwave-sidelink-mac.h:33</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a229809ca241dc9416dfb8ec82d8e48f6"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a229809ca241dc9416dfb8ec82d8e48f6">ns3::millicar::MmWaveSidelinkMac::GetRnti</a></div><div class="ttdeci">uint16_t GetRnti() const</div><div class="ttdoc">return the RNTI associated to a specific user </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00459">mmwave-sidelink-mac.cc:459</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_aeba85dc92c38c749b32d241abc30484d"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#aeba85dc92c38c749b32d241abc30484d">ns3::millicar::SlSchedulingCallback::numSym</a></div><div class="ttdeci">uint8_t numSym</div><div class="ttdoc">nummber of allocated symbols </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00039">mmwave-sidelink-mac.h:39</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_ad4c32a42bd58226a3ad07828e7b4cff0"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#ad4c32a42bd58226a3ad07828e7b4cff0">ns3::millicar::MmWaveSidelinkMac::AddMacSapUser</a></div><div class="ttdeci">void AddMacSapUser(uint8_t lcid, LteMacSapUser *macSapUser)</div><div class="ttdoc">Associate a MAC SAP user instance to the LCID and add it in the map. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00528">mmwave-sidelink-mac.cc:528</a></div></div>
<div class="ttc" id="mmwave-sidelink-mac_8h_html"><div class="ttname"><a href="mmwave-sidelink-mac_8h.html">mmwave-sidelink-mac.h</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider_html_ac15e814e840c8b50cbfa7c60eef287dd"><div class="ttname"><a href="classns3_1_1millicar_1_1_rlc_sidelink_member_mac_sap_provider.html#ac15e814e840c8b50cbfa7c60eef287dd">ns3::millicar::RlcSidelinkMemberMacSapProvider::ReportBufferStatus</a></div><div class="ttdeci">virtual void ReportBufferStatus(ReportBufferStatusParameters params)</div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00074">mmwave-sidelink-mac.cc:74</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user_html_ae204b07ff1b6fcd8d50dc71d21b51278"><div class="ttname"><a href="classns3_1_1millicar_1_1_mac_sidelink_member_phy_sap_user.html#ae204b07ff1b6fcd8d50dc71d21b51278">ns3::millicar::MacSidelinkMemberPhySapUser::SlotIndication</a></div><div class="ttdeci">void SlotIndication(mmwave::SfnSf timingInfo) override</div><div class="ttdoc">Trigger the start from a new slot (input from PHY layer) </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00048">mmwave-sidelink-mac.cc:48</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_a2acac5daa2ebddd899fe9710eb37c236"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a2acac5daa2ebddd899fe9710eb37c236">ns3::millicar::SlSchedulingCallback::subframe</a></div><div class="ttdeci">uint8_t subframe</div><div class="ttdoc">subframe number </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00036">mmwave-sidelink-mac.h:36</a></div></div>
<div class="ttc" id="classns3_1_1millicar_1_1_mm_wave_sidelink_mac_html_a8a34b3d135b391d9fc16004fb91fa208"><div class="ttname"><a href="classns3_1_1millicar_1_1_mm_wave_sidelink_mac.html#a8a34b3d135b391d9fc16004fb91fa208">ns3::millicar::MmWaveSidelinkMac::~MmWaveSidelinkMac</a></div><div class="ttdeci">~MmWaveSidelinkMac(void)</div><div class="ttdoc">Class destructor. </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8cc_source.html#l00129">mmwave-sidelink-mac.cc:129</a></div></div>
<div class="ttc" id="structns3_1_1millicar_1_1_sl_scheduling_callback_html_a68acb66f9d0cc3e2387436922f4c0c03"><div class="ttname"><a href="structns3_1_1millicar_1_1_sl_scheduling_callback.html#a68acb66f9d0cc3e2387436922f4c0c03">ns3::millicar::SlSchedulingCallback::rxRnti</a></div><div class="ttdeci">uint16_t rxRnti</div><div class="ttdoc">the RNTI which identifies the destination </div><div class="ttdef"><b>Definition:</b> <a href="mmwave-sidelink-mac_8h_source.html#l00043">mmwave-sidelink-mac.h:43</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- ns-3 doxygen header, based on
     HTML header for doxygen 1.8.3.1
     Verified compatible with 1.8.6
-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3f14f6767c31cb4a1d22c13c18cc6fc3.html">model</a></li><li class="navelem"><a class="el" href="mmwave-sidelink-mac_8cc.html">mmwave-sidelink-mac.cc</a></li>
    <li class="footer">Generated on Fri Oct 9 2020 16:39:27 for MilliCar by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
